'use strict';

var express = require('express'),
    bodyParser = require('body-parser');

var uris = require('./uris'),
    UpdateTransaction = require('./transaction/update'),
    InitialiseTransaction = require('./transaction/initialise');

var UPDATE_URI = uris.UPDATE_URI,
    INITIALISE_URI = uris.INITIALISE_URI;


var handler = function handler(Transaction) {
  return function (request, response, next) {
    var body = request.body;


    var json = body; ///

    var transaction = Transaction.fromJSON(json);

    json = transaction.toJSON();

    var statusCode = 200,
        headers = { 'Content-Type': 'application/json; charset=utf-8' },
        content = JSON.stringify(json);

    response.writeHead(statusCode, headers);

    response.write(content);

    response.end();
  };
};

var router = express.Router(),
    jsonBodyParser = bodyParser.json();

router.use(jsonBodyParser);

router.post(UPDATE_URI, handler(UpdateTransaction));

router.post(INITIALISE_URI, handler(InitialiseTransaction));

module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi9leGFtcGxlL3JvdXRlci5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImJvZHlQYXJzZXIiLCJ1cmlzIiwiVXBkYXRlVHJhbnNhY3Rpb24iLCJJbml0aWFsaXNlVHJhbnNhY3Rpb24iLCJVUERBVEVfVVJJIiwiSU5JVElBTElTRV9VUkkiLCJoYW5kbGVyIiwicmVxdWVzdCIsInJlc3BvbnNlIiwibmV4dCIsImJvZHkiLCJqc29uIiwidHJhbnNhY3Rpb24iLCJUcmFuc2FjdGlvbiIsImZyb21KU09OIiwidG9KU09OIiwic3RhdHVzQ29kZSIsImhlYWRlcnMiLCJjb250ZW50IiwiSlNPTiIsInN0cmluZ2lmeSIsIndyaXRlSGVhZCIsIndyaXRlIiwiZW5kIiwicm91dGVyIiwiUm91dGVyIiwianNvbkJvZHlQYXJzZXIiLCJ1c2UiLCJwb3N0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBTUEsVUFBVUMsUUFBUSxTQUFSLENBQWhCO0FBQUEsSUFDTUMsYUFBYUQsUUFBUSxhQUFSLENBRG5COztBQUdBLElBQU1FLE9BQU9GLFFBQVEsUUFBUixDQUFiO0FBQUEsSUFDTUcsb0JBQW9CSCxRQUFRLHNCQUFSLENBRDFCO0FBQUEsSUFFTUksd0JBQXdCSixRQUFRLDBCQUFSLENBRjlCOztJQUlRSyxVLEdBQStCSCxJLENBQS9CRyxVO0lBQVlDLGMsR0FBbUJKLEksQ0FBbkJJLGM7OztBQUVwQixJQUFNQyxVQUFVLFNBQVZBLE9BQVU7QUFBQSxTQUFlLFVBQVNDLE9BQVQsRUFBa0JDLFFBQWxCLEVBQTRCQyxJQUE1QixFQUFrQztBQUFBLFFBQ3ZEQyxJQUR1RCxHQUM5Q0gsT0FEOEMsQ0FDdkRHLElBRHVEOzs7QUFHL0QsUUFBSUMsT0FBT0QsSUFBWCxDQUgrRCxDQUc3Qzs7QUFFbEIsUUFBTUUsY0FBY0MsWUFBWUMsUUFBWixDQUFxQkgsSUFBckIsQ0FBcEI7O0FBRUFBLFdBQU9DLFlBQVlHLE1BQVosRUFBUDs7QUFFQSxRQUFNQyxhQUFhLEdBQW5CO0FBQUEsUUFDTUMsVUFBVSxFQUFFLGdCQUFnQixpQ0FBbEIsRUFEaEI7QUFBQSxRQUVNQyxVQUFVQyxLQUFLQyxTQUFMLENBQWVULElBQWYsQ0FGaEI7O0FBSUFILGFBQVNhLFNBQVQsQ0FBbUJMLFVBQW5CLEVBQStCQyxPQUEvQjs7QUFFQVQsYUFBU2MsS0FBVCxDQUFlSixPQUFmOztBQUVBVixhQUFTZSxHQUFUO0FBQ0QsR0FsQmU7QUFBQSxDQUFoQjs7QUFvQkEsSUFBTUMsU0FBUzFCLFFBQVEyQixNQUFSLEVBQWY7QUFBQSxJQUNNQyxpQkFBaUIxQixXQUFXVyxJQUFYLEVBRHZCOztBQUdBYSxPQUFPRyxHQUFQLENBQVdELGNBQVg7O0FBRUFGLE9BQU9JLElBQVAsQ0FBWXhCLFVBQVosRUFBd0JFLFFBQVFKLGlCQUFSLENBQXhCOztBQUVBc0IsT0FBT0ksSUFBUCxDQUFZdkIsY0FBWixFQUE0QkMsUUFBUUgscUJBQVIsQ0FBNUI7O0FBRUEwQixPQUFPQyxPQUFQLEdBQWlCTixNQUFqQiIsImZpbGUiOiJyb3V0ZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XHJcblxyXG5jb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpLFxyXG4gICAgICBib2R5UGFyc2VyID0gcmVxdWlyZSgnYm9keS1wYXJzZXInKTtcclxuXHJcbmNvbnN0IHVyaXMgPSByZXF1aXJlKCcuL3VyaXMnKSxcclxuICAgICAgVXBkYXRlVHJhbnNhY3Rpb24gPSByZXF1aXJlKCcuL3RyYW5zYWN0aW9uL3VwZGF0ZScpLFxyXG4gICAgICBJbml0aWFsaXNlVHJhbnNhY3Rpb24gPSByZXF1aXJlKCcuL3RyYW5zYWN0aW9uL2luaXRpYWxpc2UnKTtcclxuXHJcbmNvbnN0IHsgVVBEQVRFX1VSSSwgSU5JVElBTElTRV9VUkkgfSA9IHVyaXM7XHJcblxyXG5jb25zdCBoYW5kbGVyID0gVHJhbnNhY3Rpb24gPT4gZnVuY3Rpb24ocmVxdWVzdCwgcmVzcG9uc2UsIG5leHQpIHtcclxuICBjb25zdCB7IGJvZHkgfSA9IHJlcXVlc3Q7XHJcblxyXG4gIGxldCBqc29uID0gYm9keTsgIC8vL1xyXG5cclxuICBjb25zdCB0cmFuc2FjdGlvbiA9IFRyYW5zYWN0aW9uLmZyb21KU09OKGpzb24pO1xyXG5cclxuICBqc29uID0gdHJhbnNhY3Rpb24udG9KU09OKCk7XHJcblxyXG4gIGNvbnN0IHN0YXR1c0NvZGUgPSAyMDAsXHJcbiAgICAgICAgaGVhZGVycyA9IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04JyB9LFxyXG4gICAgICAgIGNvbnRlbnQgPSBKU09OLnN0cmluZ2lmeShqc29uKTtcclxuXHJcbiAgcmVzcG9uc2Uud3JpdGVIZWFkKHN0YXR1c0NvZGUsIGhlYWRlcnMpO1xyXG5cclxuICByZXNwb25zZS53cml0ZShjb250ZW50KTtcclxuXHJcbiAgcmVzcG9uc2UuZW5kKCk7XHJcbn07XHJcblxyXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpLFxyXG4gICAgICBqc29uQm9keVBhcnNlciA9IGJvZHlQYXJzZXIuanNvbigpO1xyXG5cclxucm91dGVyLnVzZShqc29uQm9keVBhcnNlcik7XHJcblxyXG5yb3V0ZXIucG9zdChVUERBVEVfVVJJLCBoYW5kbGVyKFVwZGF0ZVRyYW5zYWN0aW9uKSk7XHJcblxyXG5yb3V0ZXIucG9zdChJTklUSUFMSVNFX1VSSSwgaGFuZGxlcihJbml0aWFsaXNlVHJhbnNhY3Rpb24pKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcm91dGVyO1xyXG4iXX0=